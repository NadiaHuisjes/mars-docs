<p>This tutorial shows how to create and modify a <strong>MarsTable</strong> using the scripting feature in Fiji. MarsTables add the functionality of generating tables within the Fiji/ImageJ environment. For a general <a href="https://duderstadt-lab.github.io/mars-docs/tutorials/scripting/introduction-to-groovy-scripting/">introduction on Groovy scripting</a> or more <a href="https://duderstadt-lab.github.io/mars-docs/tutorials/scripting/advanced-groovy-scripting/">advanced scripting</a> the reader is referred to the scripting tutorials. A practical example of the use of a MarsTable is found in the Examples Gallery <a href="https://duderstadt-lab.github.io/mars-docs/examples/">short examples, nr2</a>.</p>

<h3 id="1-how-to-create-a-marstable">1. How to create a MarsTable</h3>
<p>This example shows how to create a MarsTable filled with dummy values. Open the script editor as explained in the <a href="https://duderstadt-lab.github.io/mars-docs/tutorials/scripting/introduction-to-groovy-scripting/">introductory tutorial</a> and run the following script.</p>

<pre><code class="language-Groovy">#@output MarsTable table

import de.mpg.biochem.mars.table.*;

//Initialize a new ResultsTable with 3 columns and no rows
table = new MarsTable(3,0)
table.setColumnHeader(0, "column1")
table.setColumnHeader(1, "column2")
table.setColumnHeader(2, "column3")

for (int row=0;row&lt;10;row++) {
   //Since we initialised the table with no rows
   //We have to increase the table size by one row
   //before we can add more values
   table.appendRow()
   table.setValue("column1", row, row*0.25)
   table.setValue("column2", row, row*0.25)
   table.setValue("column3", row, row*0.25)
}
</code></pre>

<p>This generates the following MarsTable.</p>

<p><img src="/tutorials/img/marstable/img1.png" width="450" /></p>

<p>Alternatively, the same table can be generated by first building columns and then adding them to the table.</p>

<pre><code class="language-Groovy">#@output MarsTable table

import de.mpg.biochem.mars.table.*
import org.scijava.table.*


//Initialize a new empty MARSResultsTable
table = new MarsTable()
DoubleColumn col1 = new DoubleColumn("column1")
DoubleColumn col2 = new DoubleColumn("column2")
DoubleColumn col3 = new DoubleColumn("column3")

for (int row=0;row&lt;10;row++) {
   col1.add((double)row*0.25)
   col2.add((double)row*0.25)
   col3.add((double)row*0.25)
}

table.add(col1)
table.add(col2)
table.add(col3)
</code></pre>

<h3 id="2-adding-columns-to-a-marstable">2. Adding columns to a MarsTable</h3>
<p>After a MarsTable has been generated, it can be extended in the following two ways.<br />
The first option is to create a new column, and then set the values in the column.</p>

<pre><code class="language-Groovy">#@ MarsTable table

import de.mpg.biochem.mars.table.*
import org.scijava.table.*

double val = 1

table.appendColumn("molecule")

table.setValue("molecule", 0, val)
table.setValue("molecule", 1, val)
table.setValue("molecule", 2, val)
table.setValue("molecule", 3, val+1)
table.setValue("molecule", 4, val+1)
table.setValue("molecule", 5, val+1)
table.setValue("molecule", 6, val+2)
table.setValue("molecule", 7, val+2)
table.setValue("molecule", 8, val+2)
table.setValue("molecule", 9, val+2)

table.getWindow().update()
</code></pre>

<p>Alternatively, the following script can be used.</p>

<pre><code class="language-Groovy">#@ MarsTable table

import de.mpg.biochem.mars.table.*
import org.scijava.table.*

DoubleColumn col = new DoubleColumn("molecule")

double val = 1

col.add(val)
col.add(val)
col.add(val)
col.add(val+1)
col.add(val+1)
col.add(val+1)
col.add(val+2)
col.add(val+2)
col.add(val+2)
col.add(val+2)

table.add(col)

table.getWindow().update()
</code></pre>

<p>In both cases the MarsTable is extended with the column named “molecule”.</p>

<p><img src="/tutorials/img/marstable/img2.png" width="450" /></p>

<h3 id="3-remove-a-column-from-a-marstable">3. Remove a column from a MarsTable</h3>
<p>To remove the newly added column “molecule” again use the following script.</p>

<pre><code class="language-Groovy">#@ MarsTable table

import de.mpg.biochem.mars.table.*
import org.scijava.table.*

table.removeColumn("molecule")

table.getWindow().update()
</code></pre>
